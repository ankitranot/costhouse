<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">ol{margin:0;padding:0}table td,table th{padding:0}.c1{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c0{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c3{background-color:#ffffff;max-width:468pt;padding:72pt 72pt 72pt 72pt}.c2{height:11pt}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c3 doc-content"><p class="c0"><span class="c1">&lt;!DOCTYPE html&gt;</span></p><p class="c0"><span class="c1">&lt;html lang=&quot;en&quot;&gt;</span></p><p class="c0"><span class="c1">&lt;head&gt;</span></p><p class="c0"><span class="c1">&lt;meta charset=&quot;UTF-8&quot;&gt;</span></p><p class="c0"><span class="c1">&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span></p><p class="c0"><span class="c1">&lt;title&gt;House Cost of Construction&lt;/title&gt;</span></p><p class="c0"><span class="c1">&lt;style&gt;</span></p><p class="c0"><span class="c1">body { font-family: Arial, sans-serif; margin: 20px; background: #f4f6f8; }</span></p><p class="c0"><span class="c1">h1 { text-align: center; }</span></p><p class="c0"><span class="c1">.form-group { margin-bottom: 10px; }</span></p><p class="c0"><span class="c1">label { display: inline-block; width: 120px; font-weight: bold; }</span></p><p class="c0"><span class="c1">input, select { padding: 5px; width: 200px; }</span></p><p class="c0"><span class="c1">button { padding: 6px 12px; margin: 5px; cursor: pointer; border: none; border-radius: 4px; }</span></p><p class="c0"><span class="c1">table { width: 100%; border-collapse: collapse; margin-top: 20px; background: #fff; }</span></p><p class="c0"><span class="c1">th, td { border: 1px solid #ccc; padding: 8px; text-align: center; vertical-align: top;}</span></p><p class="c0"><span class="c1">th { background: #0077cc; color: #fff; }</span></p><p class="c0"><span class="c1">tfoot td { font-weight: bold; }</span></p><p class="c0"><span class="c1">.btn-update { background: #ff9800; color: #fff; }</span></p><p class="c0"><span class="c1">.btn-delete { background: #f44336; color: #fff; }</span></p><p class="c0"><span class="c1">.btn-export { background: #4caf50; color: #fff; }</span></p><p class="c0"><span class="c1">.history { font-size: 12px; color: #555; margin-top: 5px; display: none; text-align: left; }</span></p><p class="c0"><span class="c1">.show-history-btn { font-size: 12px; padding: 2px 5px; margin-top: 2px; cursor: pointer; background: #ddd; border-radius: 3px; }</span></p><p class="c0"><span class="c1">&lt;/style&gt;</span></p><p class="c0"><span class="c1">&lt;/head&gt;</span></p><p class="c0"><span class="c1">&lt;body&gt;</span></p><p class="c0"><span class="c1">&lt;h1&gt;Construction of House &lt;/h1&gt;</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">&lt;!-- Form to add record --&gt;</span></p><p class="c0"><span class="c1">&lt;div class=&quot;form-group&quot;&gt;</span></p><p class="c0"><span class="c1">&nbsp; &lt;label&gt;Material:&lt;/label&gt;</span></p><p class="c0"><span class="c1">&nbsp; &lt;input type=&quot;text&quot; id=&quot;material&quot;&gt;</span></p><p class="c0"><span class="c1">&lt;/div&gt;</span></p><p class="c0"><span class="c1">&lt;div class=&quot;form-group&quot;&gt;</span></p><p class="c0"><span class="c1">&nbsp; &lt;label&gt;Person:&lt;/label&gt;</span></p><p class="c0"><span class="c1">&nbsp; &lt;input type=&quot;text&quot; id=&quot;person&quot;&gt;</span></p><p class="c0"><span class="c1">&lt;/div&gt;</span></p><p class="c0"><span class="c1">&lt;div class=&quot;form-group&quot;&gt;</span></p><p class="c0"><span class="c1">&nbsp; &lt;label&gt;Total Cost:&lt;/label&gt;</span></p><p class="c0"><span class="c1">&nbsp; &lt;input type=&quot;number&quot; id=&quot;totalCost&quot;&gt;</span></p><p class="c0"><span class="c1">&lt;/div&gt;</span></p><p class="c0"><span class="c1">&lt;div class=&quot;form-group&quot;&gt;</span></p><p class="c0"><span class="c1">&nbsp; &lt;label&gt;Amount Paid:&lt;/label&gt;</span></p><p class="c0"><span class="c1">&nbsp; &lt;input type=&quot;number&quot; id=&quot;amountPaid&quot;&gt;</span></p><p class="c0"><span class="c1">&lt;/div&gt;</span></p><p class="c0"><span class="c1">&lt;button onclick=&quot;addRecord()&quot;&gt;Add Record&lt;/button&gt;</span></p><p class="c0"><span class="c1">&lt;button class=&quot;btn-export&quot; onclick=&quot;exportExcel()&quot;&gt;Export Excel&lt;/button&gt;</span></p><p class="c0"><span class="c1">&lt;button class=&quot;btn-export&quot; onclick=&quot;exportPDF()&quot;&gt;Export PDF&lt;/button&gt;</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">&lt;!-- Filter by person --&gt;</span></p><p class="c0"><span class="c1">&lt;div class=&quot;form-group&quot;&gt;</span></p><p class="c0"><span class="c1">&nbsp; &lt;label&gt;Filter Person:&lt;/label&gt;</span></p><p class="c0"><span class="c1">&nbsp; &lt;select id=&quot;personFilter&quot; onchange=&quot;renderTable()&quot;&gt;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &lt;option value=&quot;&quot;&gt;All&lt;/option&gt;</span></p><p class="c0"><span class="c1">&nbsp; &lt;/select&gt;</span></p><p class="c0"><span class="c1">&lt;/div&gt;</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">&lt;!-- Table --&gt;</span></p><p class="c0"><span class="c1">&lt;table id=&quot;recordsTable&quot;&gt;</span></p><p class="c0"><span class="c1">&lt;thead&gt;</span></p><p class="c0"><span class="c1">&lt;tr&gt;</span></p><p class="c0"><span class="c1">&lt;th&gt;Date&lt;/th&gt;</span></p><p class="c0"><span class="c1">&lt;th&gt;Material&lt;/th&gt;</span></p><p class="c0"><span class="c1">&lt;th&gt;Person&lt;/th&gt;</span></p><p class="c0"><span class="c1">&lt;th&gt;Total Cost&lt;/th&gt;</span></p><p class="c0"><span class="c1">&lt;th&gt;Paid&lt;/th&gt;</span></p><p class="c0"><span class="c1">&lt;th&gt;Left&lt;/th&gt;</span></p><p class="c0"><span class="c1">&lt;th&gt;Actions&lt;/th&gt;</span></p><p class="c0"><span class="c1">&lt;/tr&gt;</span></p><p class="c0"><span class="c1">&lt;/thead&gt;</span></p><p class="c0"><span class="c1">&lt;tbody&gt;&lt;/tbody&gt;</span></p><p class="c0"><span class="c1">&lt;tfoot&gt;</span></p><p class="c0"><span class="c1">&lt;tr&gt;</span></p><p class="c0"><span class="c1">&lt;td colspan=&quot;3&quot;&gt;Grand Total&lt;/td&gt;</span></p><p class="c0"><span class="c1">&lt;td id=&quot;grandTotal&quot;&gt;0&lt;/td&gt;</span></p><p class="c0"><span class="c1">&lt;td id=&quot;grandPaid&quot;&gt;0&lt;/td&gt;</span></p><p class="c0"><span class="c1">&lt;td id=&quot;grandLeft&quot;&gt;0&lt;/td&gt;</span></p><p class="c0"><span class="c1">&lt;td&gt;&lt;/td&gt;</span></p><p class="c0"><span class="c1">&lt;/tr&gt;</span></p><p class="c0"><span class="c1">&lt;/tfoot&gt;</span></p><p class="c0"><span class="c1">&lt;/table&gt;</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js&quot;&gt;&lt;/script&gt;</span></p><p class="c0"><span class="c1">&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js&quot;&gt;&lt;/script&gt;</span></p><p class="c0"><span class="c1">&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js&quot;&gt;&lt;/script&gt;</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">&lt;script&gt;</span></p><p class="c0"><span class="c1">let records = JSON.parse(localStorage.getItem(&quot;constructionRecords&quot;)) || [];</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">// Save to localStorage</span></p><p class="c0"><span class="c1">function saveRecords() {</span></p><p class="c0"><span class="c1">&nbsp; localStorage.setItem(&quot;constructionRecords&quot;, JSON.stringify(records));</span></p><p class="c0"><span class="c1">}</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">// Update person filter dropdown</span></p><p class="c0"><span class="c1">function updatePersonFilter() {</span></p><p class="c0"><span class="c1">&nbsp; const select = document.getElementById(&quot;personFilter&quot;);</span></p><p class="c0"><span class="c1">&nbsp; const selected = select.value;</span></p><p class="c0"><span class="c1">&nbsp; const persons = [...new Set(records.map(r =&gt; r.person))].sort();</span></p><p class="c0"><span class="c1">&nbsp; select.innerHTML = &#39;&lt;option value=&quot;&quot;&gt;All&lt;/option&gt;&#39;;</span></p><p class="c0"><span class="c1">&nbsp; persons.forEach(p =&gt; {</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; const opt = document.createElement(&quot;option&quot;);</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; opt.value = p;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; opt.textContent = p;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; select.appendChild(opt);</span></p><p class="c0"><span class="c1">&nbsp; });</span></p><p class="c0"><span class="c1">&nbsp; if ([...select.options].some(o=&gt;o.value===selected)) select.value = selected;</span></p><p class="c0"><span class="c1">}</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">// Toggle history visibility</span></p><p class="c0"><span class="c1">function toggleHistory(id) {</span></p><p class="c0"><span class="c1">&nbsp; const div = document.getElementById(id);</span></p><p class="c0"><span class="c1">&nbsp; div.style.display = div.style.display === &#39;none&#39; ? &#39;block&#39; : &#39;none&#39;;</span></p><p class="c0"><span class="c1">}</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">// Render table</span></p><p class="c0"><span class="c1">function renderTable() {</span></p><p class="c0"><span class="c1">&nbsp; const tbody = document.querySelector(&quot;#recordsTable tbody&quot;);</span></p><p class="c0"><span class="c1">&nbsp; tbody.innerHTML = &quot;&quot;;</span></p><p class="c0"><span class="c1">&nbsp; let total=0, paid=0, left=0;</span></p><p class="c0"><span class="c1">&nbsp; const filterPerson = document.getElementById(&quot;personFilter&quot;).value;</span></p><p class="c0"><span class="c1">&nbsp; const filteredRecords = filterPerson ? records.filter(r=&gt;r.person===filterPerson):records;</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">&nbsp; filteredRecords.forEach((rec,i)=&gt;{</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; const tr=document.createElement(&quot;tr&quot;);</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; const leftAmount = rec.totalCost - rec.amountPaid;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; const historyId = &quot;history-&quot;+i;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; const historyHTML = rec.history ? rec.history.map(h=&gt;`${h.date}: +${h.added} &rarr; Total ${h.amountPaid}`).join(&#39;&lt;br&gt;&#39;) : &#39;&#39;;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; tr.innerHTML=`</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &lt;td&gt;${rec.date}&lt;/td&gt;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &lt;td&gt;${rec.material}&lt;/td&gt;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &lt;td&gt;${rec.person}&lt;/td&gt;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &lt;td&gt;${rec.totalCost}&lt;/td&gt;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &lt;td&gt;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; ${rec.amountPaid}</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;div class=&quot;show-history-btn&quot; onclick=&quot;toggleHistory(&#39;${historyId}&#39;)&quot;&gt;Show History&lt;/div&gt;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;div class=&quot;history&quot; id=&quot;${historyId}&quot;&gt;${historyHTML}&lt;/div&gt;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &lt;/td&gt;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &lt;td&gt;${leftAmount}&lt;/td&gt;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &lt;td&gt;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;button class=&quot;btn-update&quot; onclick=&quot;updatePaid(${records.indexOf(rec)})&quot;&gt;Add Paid&lt;/button&gt;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &nbsp; &lt;button class=&quot;btn-delete&quot; onclick=&quot;deleteRecord(${records.indexOf(rec)})&quot;&gt;Delete&lt;/button&gt;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; &nbsp; &lt;/td&gt;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; `;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; tbody.appendChild(tr);</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; total+=rec.totalCost;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; paid+=rec.amountPaid;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; left+=leftAmount;</span></p><p class="c0"><span class="c1">&nbsp; });</span></p><p class="c0"><span class="c1">&nbsp; document.getElementById(&quot;grandTotal&quot;).textContent=total;</span></p><p class="c0"><span class="c1">&nbsp; document.getElementById(&quot;grandPaid&quot;).textContent=paid;</span></p><p class="c0"><span class="c1">&nbsp; document.getElementById(&quot;grandLeft&quot;).textContent=left;</span></p><p class="c0"><span class="c1">&nbsp; updatePersonFilter();</span></p><p class="c0"><span class="c1">}</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">// Add new record</span></p><p class="c0"><span class="c1">function addRecord() {</span></p><p class="c0"><span class="c1">&nbsp; const material = document.getElementById(&quot;material&quot;).value.trim();</span></p><p class="c0"><span class="c1">&nbsp; const person = document.getElementById(&quot;person&quot;).value.trim();</span></p><p class="c0"><span class="c1">&nbsp; const totalCost = parseFloat(document.getElementById(&quot;totalCost&quot;).value)||0;</span></p><p class="c0"><span class="c1">&nbsp; const amountPaid = parseFloat(document.getElementById(&quot;amountPaid&quot;).value)||0;</span></p><p class="c0"><span class="c1">&nbsp; if(!material||!person){alert(&quot;Please enter Material and Person name.&quot;); return;}</span></p><p class="c0"><span class="c1">&nbsp; const today = new Date().toLocaleDateString(&quot;en-GB&quot;);</span></p><p class="c0"><span class="c1">&nbsp; const rec = {date:today,material,person,totalCost,amountPaid,history:[{date:today,added:amountPaid,amountPaid:amountPaid}]};</span></p><p class="c0"><span class="c1">&nbsp; records.push(rec);</span></p><p class="c0"><span class="c1">&nbsp; saveRecords();</span></p><p class="c0"><span class="c1">&nbsp; renderTable();</span></p><p class="c0"><span class="c1">&nbsp; document.getElementById(&quot;material&quot;).value=&quot;&quot;;</span></p><p class="c0"><span class="c1">&nbsp; document.getElementById(&quot;person&quot;).value=&quot;&quot;;</span></p><p class="c0"><span class="c1">&nbsp; document.getElementById(&quot;totalCost&quot;).value=&quot;&quot;;</span></p><p class="c0"><span class="c1">&nbsp; document.getElementById(&quot;amountPaid&quot;).value=&quot;&quot;;</span></p><p class="c0"><span class="c1">}</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">// Update Paid Amount (add to existing)</span></p><p class="c0"><span class="c1">function updatePaid(index) {</span></p><p class="c0"><span class="c1">&nbsp; const addPaid = prompt(&quot;Enter amount to add to Paid Amount:&quot;, &quot;0&quot;);</span></p><p class="c0"><span class="c1">&nbsp; if (addPaid !== null) {</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; const addedAmount = parseFloat(addPaid) || 0;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; records[index].amountPaid += addedAmount;</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; const today = new Date().toLocaleDateString(&quot;en-GB&quot;);</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; if(!records[index].history) records[index].history=[];</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; records[index].history.push({ date: today, added: addedAmount, amountPaid: records[index].amountPaid });</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; saveRecords();</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; renderTable();</span></p><p class="c0"><span class="c1">&nbsp; }</span></p><p class="c0"><span class="c1">}</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">// Delete record</span></p><p class="c0"><span class="c1">function deleteRecord(index){</span></p><p class="c0"><span class="c1">&nbsp; if(confirm(&quot;Are you sure to delete this record?&quot;)){</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; records.splice(index,1);</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; saveRecords();</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; renderTable();</span></p><p class="c0"><span class="c1">&nbsp; }</span></p><p class="c0"><span class="c1">}</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">// Totals</span></p><p class="c0"><span class="c1">function getTotals(arr=records){</span></p><p class="c0"><span class="c1">&nbsp; let total=0, paid=0, left=0;</span></p><p class="c0"><span class="c1">&nbsp; arr.forEach(r=&gt;{total+=r.totalCost; paid+=r.amountPaid; left+=r.totalCost-r.amountPaid;});</span></p><p class="c0"><span class="c1">&nbsp; return {total,paid,left};</span></p><p class="c0"><span class="c1">}</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">// Export Excel</span></p><p class="c0"><span class="c1">function exportExcel(){</span></p><p class="c0"><span class="c1">&nbsp; const wb=XLSX.utils.book_new();</span></p><p class="c0"><span class="c1">&nbsp; const ws_data=[[&quot;Date&quot;,&quot;Material&quot;,&quot;Person&quot;,&quot;Total Cost&quot;,&quot;Paid&quot;,&quot;Left&quot;,&quot;History&quot;]];</span></p><p class="c0"><span class="c1">&nbsp; const filterPerson = document.getElementById(&quot;personFilter&quot;).value;</span></p><p class="c0"><span class="c1">&nbsp; const exportRecords = filterPerson?records.filter(r=&gt;r.person===filterPerson):records;</span></p><p class="c0"><span class="c1">&nbsp; exportRecords.forEach(r=&gt;{</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; const historyStr = r.history.map(h=&gt;`${h.date}: +${h.added} &rarr; Total ${h.amountPaid}`).join(&quot;\n&quot;);</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; ws_data.push([r.date,r.material,r.person,r.totalCost,r.amountPaid,r.totalCost-r.amountPaid,historyStr]);</span></p><p class="c0"><span class="c1">&nbsp; });</span></p><p class="c0"><span class="c1">&nbsp; ws_data.push([&quot;Grand Total&quot;,&quot;&quot;,&quot;&quot;,getTotals(exportRecords).total,getTotals(exportRecords).paid,getTotals(exportRecords).left,&quot;&quot;]);</span></p><p class="c0"><span class="c1">&nbsp; const ws=XLSX.utils.aoa_to_sheet(ws_data);</span></p><p class="c0"><span class="c1">&nbsp; XLSX.utils.book_append_sheet(wb,ws,&quot;Records&quot;);</span></p><p class="c0"><span class="c1">&nbsp; XLSX.writeFile(wb,&quot;Construction_Records.xlsx&quot;);</span></p><p class="c0"><span class="c1">}</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">// Export PDF</span></p><p class="c0"><span class="c1">function exportPDF(){</span></p><p class="c0"><span class="c1">&nbsp; const { jsPDF } = window.jspdf;</span></p><p class="c0"><span class="c1">&nbsp; const doc = new jsPDF();</span></p><p class="c0"><span class="c1">&nbsp; doc.text(&quot;House Cost of Construction&quot;,14,15);</span></p><p class="c0"><span class="c1">&nbsp; const filterPerson = document.getElementById(&quot;personFilter&quot;).value;</span></p><p class="c0"><span class="c1">&nbsp; const exportRecords = filterPerson?records.filter(r=&gt;r.person===filterPerson):records;</span></p><p class="c0"><span class="c1">&nbsp; const tableData = exportRecords.map(r=&gt;[</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; r.date,r.material,r.person,r.totalCost,r.amountPaid,r.totalCost-r.amountPaid,</span></p><p class="c0"><span class="c1">&nbsp; &nbsp; r.history.map(h=&gt;`${h.date}: +${h.added} &rarr; Total ${h.amountPaid}`).join(&quot;\n&quot;)</span></p><p class="c0"><span class="c1">&nbsp; ]);</span></p><p class="c0"><span class="c1">&nbsp; tableData.push([&quot;Grand Total&quot;,&quot;&quot;,&quot;&quot;,getTotals(exportRecords).total,getTotals(exportRecords).paid,getTotals(exportRecords).left,&quot;&quot;]);</span></p><p class="c0"><span class="c1">&nbsp; doc.autoTable({head:[[&quot;Date&quot;,&quot;Material&quot;,&quot;Person&quot;,&quot;Total Cost&quot;,&quot;Paid&quot;,&quot;Left&quot;,&quot;History&quot;]],body:tableData,startY:20});</span></p><p class="c0"><span class="c1">&nbsp; doc.save(&quot;Construction_Records.pdf&quot;);</span></p><p class="c0"><span class="c1">}</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0"><span class="c1">// Initial render</span></p><p class="c0"><span class="c1">renderTable();</span></p><p class="c0"><span class="c1">&lt;/script&gt;</span></p><p class="c0"><span class="c1">&lt;/body&gt;</span></p><p class="c0"><span class="c1">&lt;/html&gt;</span></p><p class="c0 c2"><span class="c1"></span></p><p class="c0 c2"><span class="c1"></span></p></body></html>